<?xml version="1.0" encoding="utf-8" ?>
<toolkit:Popup
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    xmlns:models="clr-namespace:MauiAppUIDemo.Models"
    xmlns:converter="clr-namespace:MauiAppUIDemo.Converter"
    x:Class="MauiAppUIDemo.Views.SelectDiscountPopup"
    Size="400,500">

    <toolkit:Popup.Resources>
        <converter:BoolToColorConverter x:Key="BoolToColorConverter" />
    </toolkit:Popup.Resources>

    <Border BackgroundColor="White"
            Padding="20"
            Stroke="#ccc"
            StrokeThickness="1"
            StrokeShape="RoundRectangle 20">
        <VerticalStackLayout Spacing="15">

            <Label Text="Chọn mã giảm giá"
                   FontAttributes="Bold"
                   FontSize="18"
                   HorizontalOptions="Center" />

            <CollectionView x:Name="DiscountList"
                            SelectionMode="Single"
                            SelectionChanged="OnSelectionChanged"
                            HeightRequest="350">
                <CollectionView.ItemTemplate>
                    <DataTemplate x:DataType="models:DiscountCode">
                        <Frame BackgroundColor="{Binding IsValidForTotalCached, Converter={StaticResource BoolToColorConverter}}"
                               BorderColor="#ccc"
                               CornerRadius="12"
                               Padding="10"
                               Margin="5">
                            <VerticalStackLayout>
                                <Label Text="{Binding Name}" FontAttributes="Bold" />
                                <Label Text="{Binding Description}" FontSize="13" />
                                <Label Text="{Binding DisplayText}" FontSize="11" TextColor="Gray" />
                            </VerticalStackLayout>
                        </Frame>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <HorizontalStackLayout Spacing="20" HorizontalOptions="Center">
                <Button Text="Hủy"
                        BackgroundColor="#6200EA"
                        TextColor="White"
                        Clicked="OnCancelClicked"
                        WidthRequest="100" />
                <Button Text="Áp dụng"
                        BackgroundColor="#6200EA"
                        TextColor="White"
                        Clicked="OnApplyClicked"
                        WidthRequest="100" />
            </HorizontalStackLayout>

        </VerticalStackLayout>
    </Border>
</toolkit:Popup>
